---
date: 2025-12-09
description: เรียนรู้วิธีบีบอัดไดเรกทอรีโดยใช้ Aspose.Zip สำหรับ .NET และสร้างไฟล์
  zip อย่างมีประสิทธิภาพ ปรับปรุงการใช้พื้นที่จัดเก็บในแอปพลิเคชัน .NET ของคุณ
linktitle: How to Compress a Directory
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: วิธีบีบอัดไดเรกทอรีโดยใช้ Aspose.Zip สำหรับ .NET
url: /th/net/directory-and-folder-compression/compress-directory/
weight: 10
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การบีบอัดไดเรกทอรีอย่างง่ายดายด้วย Aspose.Zip สำหรับ .NET

ในบทแนะนำนี้ เราจะสาธิต **วิธีบีบอัดไดเรกทอรี** ด้วย Aspose.Zip สำหรับ .NET ซึ่งเป็นวิธีที่ทรงพลังในการจัดการชุดข้อมูลขนาดใหญ่และประหยัดพื้นที่จัดเก็บ ไม่ว่าคุณจะกำลังสร้างยูทิลิตี้บนเดสก์ท็อปหรือบริการบนคลาวด์ การบีบอัดโฟลเดอร์อย่างมีประสิทธิภาพสามารถปรับปรุงประสิทธิภาพและลดค่าใช้จ่ายได้อย่างมาก เราจะเดินผ่านแต่ละขั้นตอน อธิบายเหตุผลเบื้องหลังโค้ด และชี้ให้เห็นข้อผิดพลาดทั่วไป เพื่อให้คุณนำเทคนิคนี้ไปใช้ด้วยความมั่นใจ

## คำตอบอย่างรวดเร็ว
- **Aspose.Zip ทำอะไร?** มันให้ API .NET ที่ง่ายสำหรับการสร้างและแยกไฟล์ ZIP โดยไม่ต้องพึ่งพาไลบรารีภายนอก.  
- **การดำเนินการใช้เวลานานเท่าไหร่?** ปกติใช้เวลาน้อยกว่า 10 นาทีสำหรับการบีบอัดไดเรกทอรีพื้นฐาน.  
- **เวอร์ชัน .NET ที่รองรับคืออะไร?** .NET Framework 4.5+, .NET Core 3.1+, และ .NET 5/6+.  
- **ต้องการไลเซนส์สำหรับการใช้งานในผลิตภัณฑ์หรือไม่?** ใช่ ต้องมีไลเซนส์เชิงพาณิชย์สำหรับการใช้งานในผลิตภัณฑ์.  
- **สามารถบีบอัดหลายโฟลเดอร์พร้อมกันได้หรือไม่?** แน่นอน — ใช้เมธอด `CreateEntries` กับคอลเลกชัน `DirectoryInfo` ใดก็ได้.

## บทนำ

Aspose.Zip สำหรับ .NET เป็นไลบรารีที่ทรงพลังซึ่งช่วยให้ผู้พัฒนา .NET ทำงานกับไฟล์และไดเรกทอรีที่บีบอัดได้อย่างราบรื่น ไม่ว่าคุณจะจัดการกับชุดข้อมูลขนาดใหญ่หรือจำเป็นต้อง **สร้างไฟล์ zip แบบ c#**‑style, Aspose.Zip มีชุดคุณสมบัติที่แข็งแกร่งสำหรับงานบีบอัดและการแตกไฟล์.

## “วิธีบีบอัดไดเรกทอรี” คืออะไร?

การบีบอัดไดเรกทอรีหมายถึงการนำไฟล์และโฟลเดอร์ย่อยทั้งหมดในโฟลเดอร์ที่กำหนดมาบรรจุในไฟล์ ZIP เดียว ซึ่งช่วยลดขนาดโดยรวม ทำให้การโอนย้ายง่ายขึ้น และคงลำดับชั้นของโฟลเดอร์เดิมไว้

## ทำไมต้องใช้ Aspose.Zip สำหรับงานนี้?

- **ความเร็วและประสิทธิภาพ:** อัลกอริทึมที่ปรับแต่งช่วยจัดการโฟลเดอร์ขนาดใหญ่ได้อย่างรวดเร็ว.  
- **Pure .NET:** ไม่ต้องใช้ไบนารีเนทีฟหรือเครื่องมือของบุคคลที่สาม.  
- **ชุดคุณสมบัติครบครัน:** รองรับการป้องกันด้วยรหัสผ่าน การสตรีมมิ่ง และการเพิ่มรายการแบบเรียลไทม์ — เหมาะสำหรับสถานการณ์ **zip multiple files .net**.  
- **API สม่ำเสมอ:** ทำงานเหมือนกันบน .NET Framework, .NET Core, และ .NET 5/6.

## ข้อกำหนดเบื้องต้น

- **Aspose.Zip for .NET** – ดาวน์โหลดได้จาก [here](https://releases.aspose.com/zip/net/).  
- **สภาพแวดล้อมการพัฒนา** – Visual Studio, Rider หรือ IDE ใด ๆ ที่รองรับ C#.  
- **ไดเรกทอรีเอกสาร** – แทนที่ `"Your Document Directory"` ในโค้ดด้วยเส้นทางของโฟลเดอร์ที่ต้องการบีบอัด.  
- **เอกสารอ้างอิง** – ดูเอกสารอย่างเป็นทางการที่ [here](https://reference.aspose.com/zip/net/).

## นำเข้า Namespaces

เริ่มต้นโดยการนำเข้า namespaces ที่จำเป็น ซึ่งจะให้คุณเข้าถึงคลาสการบีบอัดหลัก.

```csharp
using Aspose.Zip;
using System.IO;
```

## วิธีบีบอัดโฟลเดอร์ด้วย Aspose.Zip

ด้านล่างเป็นตัวอย่างที่เรียบง่ายซึ่งแสดง **วิธีบีบอัดโฟลเดอร์** เนื้อหาแบบเดียวกันสามารถขยายเป็น **zip multiple files .net** หรือสร้างโครงสร้างอาร์ไคฟ์แบบกำหนดเองได้.

### ขั้นตอนที่ 1: กำหนดค่าไดเรกทอรีเอกสารของคุณ

กำหนดตัวแปร `dataDir` ให้เป็นเส้นทางของไดเรกทอรีที่ต้องการบีบอัด.

```csharp
string dataDir = "Your Document Directory";
```

### ขั้นตอนที่ 2: สร้างไฟล์ ZIP ผลลัพธ์

เปิดอ็อบเจ็กต์ `FileStream` สองตัวสำหรับไฟล์ ZIP ผลลัพธ์ ซึ่งแสดงว่าคุณสามารถสร้างอาร์ไคฟ์มากกว่าหนึ่งไฟล์จากแหล่งเดียวกัน — มีประโยชน์สำหรับการสำรองข้อมูลแบบเวอร์ชัน.

```csharp
using (FileStream zipFile = File.Open(dataDir + "CompressDirectory_out.zip", FileMode.Create))
{
    using (FileStream zipFile2 = File.Open(dataDir + "CompressDirectory2_out.zip", FileMode.Create))
    {
```

### ขั้นตอนที่ 3: บีบอัดไดเรกทอรี

ใช้คลาส `Archive` เพื่อเพิ่มรายการทั้งหมดจากโฟลเดอร์เป้าหมาย ตัวอย่างใช้โฟลเดอร์ตัวอย่างชื่อ **CanterburyCorpus** แต่คุณสามารถชี้ไปยังไดเรกทอรีใดก็ได้.

```csharp
        using (Archive archive = new Archive())
        {
            DirectoryInfo corpus = new DirectoryInfo(dataDir + "CanterburyCorpus");
            archive.CreateEntries(corpus);
            archive.Save(zipFile);
            archive.Save(zipFile2);
        }
    }
}
```

> **เคล็ดลับ:** หากคุณต้องการ **สร้าง zip archive .net** ด้วยระดับการบีบอัดที่กำหนด ให้ตั้งค่า `archive.CompressionLevel` ก่อนเรียก `Save`.

## ปัญหาทั่วไปและวิธีแก้

| อาการ | สาเหตุที่เป็นไปได้ | วิธีแก้ |
|---------|--------------|-----|
| ไฟล์ ZIP ว่าง | `dataDir` ชี้ไปยังโฟลเดอร์ที่ผิดหรือขาดเครื่องหมายสแลชท้าย | ตรวจสอบเส้นทางและให้แน่ใจว่าโฟลเดอร์มีไฟล์อยู่ |
| `UnauthorizedAccessException` | แอปพลิเคชันไม่มีสิทธิ์เข้าถึงระบบไฟล์ | เรียก Visual Studio ด้วยสิทธิผู้ดูแลระบบหรือให้สิทธิ์การอ่าน/เขียน |
| การใช้หน่วยความจำสูงสำหรับไดเรกทอรีขนาดใหญ่ | โหลดรายการทั้งหมดเข้าสู่หน่วยความจำพร้อมกัน | ใช้ `Archive.CreateEntryFromFile` ในลูปเพื่อสตรีมไฟล์แต่ละไฟล์แยกกัน |

## คำถามที่พบบ่อย (เพิ่มเติม)

**ถาม: ฉันสามารถเพิ่มรหัสผ่านให้กับไฟล์ ZIP ได้หรือไม่?**  
ตอบ: ใช่ ตั้งค่า `archive.Password = "yourPassword";` ก่อนเรียก `Save`.

**ถาม: ฉันจะรวมเฉพาะประเภทไฟล์บางประเภทได้อย่างไร?**  
ตอบ: กรองคอลเลกชัน `DirectoryInfo` ด้วย `GetFiles("*.txt")` หรือวิธีที่คล้ายกันก่อนเรียก `CreateEntries`.

**ถาม: มีวิธีอัปเดตไฟล์ ZIP ที่มีอยู่โดยไม่ต้องสร้างใหม่หรือไม่?**  
ตอบ: Aspose.Zip รองรับการอัปเดตแบบเพิ่มขั้นโดยใช้ `Archive.UpdateEntry`.

## คำถามที่พบบ่อย

### Q1: ฉันสามารถใช้ Aspose.Zip สำหรับ .NET ในโครงการเชิงพาณิชย์และส่วนบุคคลได้หรือไม่?

A1: ใช่, Aspose.Zip สำหรับ .NET มีไลเซนส์สำหรับการใช้งานเชิงพาณิชย์และส่วนบุคคล.

### Q2: มีการทดลองใช้งานฟรีหรือไม่?

A2: มี, คุณสามารถสำรวจการทดลองใช้งานฟรีได้ที่ [here](https://releases.aspose.com/zip/net).

### Q3: ฉันจะรับการสนับสนุนสำหรับ Aspose.Zip สำหรับ .NET ได้อย่างไร?

A3: เยี่ยมชม [Aspose.Zip forum](https://forum.aspose.com/c/zip/37) เพื่อรับการสนับสนุนจากชุมชน หรือพิจารณาซื้อ [temporary license](https://purchase.aspose.com/temporary-license/) เพื่อรับความช่วยเหลือโดยเฉพาะ.

### Q4: มีตัวอย่างและบทแนะนำอื่น ๆ ให้ใช้งานหรือไม่?

A4: มี, [documentation](https://reference.aspose.com/zip/net/) มีตัวอย่างและบทแนะนำที่ครอบคลุม.

### Q5: ฉันสามารถซื้อ Aspose.Zip สำหรับ .NET ได้หรือไม่?

A5: แน่นอน, คุณสามารถทำการซื้อได้ที่ [here](https://purchase.aspose.com/buy).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}

---

**อัปเดตล่าสุด:** 2025-12-09  
**ทดสอบด้วย:** Aspose.Zip 24.11 for .NET  
**ผู้เขียน:** Aspose
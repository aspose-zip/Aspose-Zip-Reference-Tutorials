---
date: 2025-12-20
description: Изучите, как создавать защищённые паролем zip‑архивы в .NET с помощью
  Aspose.Zip. Это пошаговое руководство показывает, как сжимать файлы с паролями,
  задавать пароль для записи в zip и использовать шифрование AES.
linktitle: Compress Files with Individual Passwords
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Создание ZIP‑файлов с защитой паролем в .NET с помощью Aspose.Zip
url: /ru/net/password-protection-and-encryption/compress-files-individual-passwords/
weight: 16
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Создание ZIP‑файлов с паролем в .NET с помощью Aspose.Zip

## Введение

Если вам нужно **создать zip‑архив с паролем** в приложении .NET, Aspose.Zip делает это простым. Присваивая уникальный пароль каждому элементу, вы можете защитить конфиденциальные документы, сохранив при этом удобство ZIP‑сжатия. В этом руководстве вы узнаете, как сжимать файлы с индивидуальными паролями, выбирать различные методы шифрования и задавать пароль для записи zip‑архива — всё с помощью понятного, готового к продакшену кода.

## Быстрые ответы
- **Какую библиотеку использовать?** Aspose.Zip для .NET.  
- **Можно ли задать разный пароль для каждого файла?** Да, каждая запись может иметь свой пароль.  
- **Какие алгоритмы шифрования поддерживаются?** Традиционный ZipCrypto, AES‑128 и AES‑256.  
- **Нужна ли лицензия для разработки?** Бесплатная пробная версия подходит для тестирования; коммерческая лицензия требуется для продакшена.  
- **Совместимо ли это с .NET 6+?** Абсолютно — API нацелено на .NET Standard 2.0 и выше.

## Что означает «создание zip‑архива с паролем»?
Создание zip‑архива с паролем подразумевает добавление шифрования к одной или нескольким записям внутри ZIP‑файла, так что содержимое нельзя открыть без правильного пароля. Это идеальный способ передачи конфиденциальных файлов, хранения резервных копий или соблюдения политик защиты данных.

## Почему стоит использовать Aspose.Zip для архивов с паролем?
- **Тонкий контроль** — задавайте отдельный пароль для каждого файла.  
- **Несколько вариантов шифрования** — от устаревшего ZipCrypto до надёжного AES‑128/256.  
- **Без внешних зависимостей** — чистая .NET‑библиотека, лёгкая в интеграции.  
- **Полная документация** — включает **aspose zip tutorial** для более сложных сценариев.

## Требования

Перед тем как приступить к руководству, убедитесь, что у вас есть следующее:

- Aspose.Zip для .NET: убедитесь, что библиотека Aspose.Zip установлена в вашем .NET‑проекте. Необходимую документацию можно найти [здесь](https://reference.aspose.com/zip/net/).

- Скачать: если вы ещё этого не сделали, загрузите библиотеку Aspose.Zip для .NET по [этой ссылке](https://releases.aspose.com/zip/net/).

- Каталог с документами: подготовьте каталог, содержащий файлы, которые нужно сжать.

## Импорт пространств имён

В вашем .NET‑проекте импортируйте необходимые пространства имён:

```csharp
using Aspose.Zip;
using Aspose.Zip.Saving;
using System.IO;
```

## Шаг 1: Установите путь к каталогу ресурсов

Определите путь к каталогу ресурсов, где находятся исходные файлы.

```csharp
string dataDir = "Your Document Directory";
```

## Шаг 2: Сжатие файлов с индивидуальными паролями

Теперь сожмём файлы с индивидуальными паролями. Мы используем три примерных файла (`alice29.txt`, `asyoulik.txt` и `fields.c`) с разными паролями для каждого. Это демонстрирует, как **сжимать файлы с паролями** и как **задать пароль для записи zip** с различными схемами шифрования, включая **zip‑архив с aes**.

```csharp
using (FileStream zipFile = File.Open(dataDir + "CompressFilesWithIndividualPasswords_out.zip", FileMode.Create))
{
    FileInfo source1 = new FileInfo(dataDir + "alice29.txt");
    FileInfo source2 = new FileInfo(dataDir + "asyoulik.txt");
    FileInfo source3 = new FileInfo(dataDir + "fields.c");

    using (var archive = new Archive())
    {
        // Compress each file with an individual password
        archive.CreateEntry("alice29.txt", source1, true, new ArchiveEntrySettings(new DeflateCompressionSettings(), new TraditionalEncryptionSettings("pass1")));
        archive.CreateEntry("asyoulik.txt", source2, true, new ArchiveEntrySettings(new DeflateCompressionSettings(), new AesEcryptionSettings("pass2", EncryptionMethod.AES128)));
        archive.CreateEntry("fields.c", source3, true, new ArchiveEntrySettings(new DeflateCompressionSettings(), new AesEcryptionSettings("pass3", EncryptionMethod.AES256)));
        
        // Save the compressed files
        archive.Save(zipFile);
    }
}
```

### Как это работает
- **TraditionalEncryptionSettings** использует старый алгоритм ZipCrypto (совместим с большинством ZIP‑утилит).  
- **AesEcryptionSettings** позволяет выбрать AES‑128 или AES‑256 для более сильной защиты.  
- Каждый вызов `CreateEntry` получает объект `ArchiveEntrySettings`, где указываются метод сжатия и параметры шифрования, эффективно **защищая паролем записи zip‑архива**.

## Распространённые проблемы и решения

| Проблема | Причина | Решение |
|----------|---------|---------|
| “Invalid password” при открытии ZIP | Несоответствие между паролем, использованным в коде, и тем, который вводит пользователь | Проверьте точную строку, переданную в `TraditionalEncryptionSettings` или `AesEcryptionSettings`. |
| Старые инструменты извлечения не открывают AES‑зашифрованные записи | Не все ZIP‑утилиты поддерживают AES‑шифрование | Используйте традиционный метод ZipCrypto для максимальной совместимости или порекомендуйте пользователям современный инструмент (например, 7‑Zip). |
| Большие файлы вызывают `OutOfMemoryException` | Загрузка огромных файлов в память перед сжатием | Потоково передавайте файл с помощью `FileStream`, не загружая весь файл в объект `FileInfo`. |

## Часто задаваемые вопросы (FAQ)

### Можно ли использовать разные методы шифрования для каждого файла?
Да, Aspose.Zip для .NET позволяет применять разные методы шифрования к каждому файлу во время сжатия.

### Есть ли доступна пробная версия?
Да, бесплатную пробную версию Aspose.Zip для .NET можно получить [здесь](https://releases.aspose.com/).

### Как получить поддержку при возникновении проблем?
Посетите [форум Aspose.Zip](https://forum.aspose.com/c/zip/37) для получения помощи от сообщества и службы поддержки Aspose.

### Где найти подробную документацию по Aspose.Zip для .NET?
Документация доступна [здесь](https://reference.aspose.com/zip/net/).

### Можно ли приобрести временную лицензию для тестирования?
Да, временную лицензию можно оформить [здесь](https://purchase.aspose.com/temporary-license/).

## Дополнительные быстрые вопросы

**В: Поддерживает ли библиотека .NET Core и .NET 5/6?**  
О: Да, Aspose.Zip ориентировано на .NET Standard, что делает его совместимым с .NET Framework, .NET Core и .NET 5/6.

**В: Можно ли добавить комментарий к каждой записи ZIP?**  
О: Хотя Aspose.Zip сосредоточен на сжатии и шифровании, вы можете хранить метаданные в отдельном манифест‑файле внутри архива.

**В: Возможно ли зашифровать весь архив одним паролем?**  
О: Вы можете задать пароль каждой записи отдельно (как показано) или применить один и тот же пароль ко всем записям для более простого подхода «zip‑archive with aes».

## Заключение

Теперь вы знаете, как **создавать zip‑файлы с паролем** в .NET с помощью Aspose.Zip. Присваивая индивидуальные пароли и выбирая подходящий метод шифрования, вы обеспечите безопасность данных без потери удобства ZIP‑сжатия. Исследуйте другие возможности Aspose.Zip, такие как потоковая передача больших файлов, добавление пользовательских метаданных и интеграция с облачными хранилищами для ещё более мощных сценариев.

---

**Last Updated:** 2025-12-20  
**Tested With:** Aspose.Zip for .NET 23.12  
**Author:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
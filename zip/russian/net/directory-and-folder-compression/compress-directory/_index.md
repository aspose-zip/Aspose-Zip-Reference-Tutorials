---
date: 2026-02-12
description: Узнайте, как упаковать папку с помощью Aspose.Zip для .NET, эффективно
  создавать zip‑архивы в .NET и уменьшать объём занимаемого места в ваших .NET‑приложениях.
linktitle: How to Zip a Folder
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Как заархивировать папку с помощью Aspose.Zip для .NET
url: /ru/net/directory-and-folder-compression/compress-directory/
weight: 10
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Как заархивировать папку с помощью Aspose.Zip для .NET

В этом руководстве вы узнаете **как заархивировать папку** быстро и надёжно с помощью Aspose.Zip для .NET. Независимо от того, создаёте ли вы настольную утилиту, облачный сервис или автоматический скрипт резервного копирования, сжатие папки в ZIP‑архив может существенно уменьшить объём хранилища и ускорить передачу по сети. Мы пройдём каждый шаг, объясним, почему каждая строка кода важна, и укажем типичные подводные камни, чтобы вы могли применять эту технику с уверенностью.

## Быстрые ответы
- **Что делает Aspose.Zip?** Предоставляет простой .NET API для создания и извлечения ZIP‑архивов без внешних зависимостей.  
- **Сколько времени занимает реализация?** Обычно менее 10 минут для базового сжатия папки.  
- **Какие версии .NET поддерживаются?** .NET Framework 4.5+, .NET Core 3.1+, и .NET 5/6+.  
- **Нужна ли лицензия для продакшн?** Да, для использования в продакшн‑среде требуется коммерческая лицензия.  
- **Можно ли сжать несколько папок одновременно?** Конечно — используйте метод `CreateEntries` для любой коллекции `DirectoryInfo`, чтобы **zip multiple folders** за один запуск.

## Что такое «как заархивировать папку»?

Сжатие папки означает взятие всех файлов и подпапок внутри указанного каталога и упаковывание их в один ZIP‑архив. Это уменьшает общий размер, сохраняет исходную иерархию и упрощает передачу или хранение данных.

## Почему стоит использовать Aspose.Zip для этой задачи?

- **Скорость и эффективность:** Оптимизированные алгоритмы быстро обрабатывают большие папки.  
- **Чистый .NET:** Не требуется нативных бинарных файлов или сторонних инструментов.  
- **Богатый набор функций:** Поддерживает защиту паролем (`add password zip`), потоковую передачу и настройку уровня сжатия (`set compression level`).  
- **Последовательный API:** Работает одинаково в .NET Framework, .NET Core и .NET 5/6, что делает его идеальным для сценариев **create zip archive .net**.  

## Предварительные требования

- **Aspose.Zip for .NET** – скачайте его [здесь](https://releases.aspose.com/zip/net/).  
- **Среда разработки** – Visual Studio, Rider или любой IDE, поддерживающий C#.  
- **Каталог документов** – замените `"Your Document Directory"` в коде на путь к папке, которую хотите сжать.  
- **Документация** – обратитесь к официальным документам [здесь](https://reference.aspose.com/zip/net/).

## Импорт пространств имён

Начните с импорта необходимых пространств имён. Они дают доступ к основным классам сжатия.

```csharp
using Aspose.Zip;
using System.IO;
```

## Как заархивировать папку с Aspose.Zip

Ниже приведён простой пример, демонстрирующий **how to zip folder** содержимое. Тот же шаблон можно расширить для **zip multiple files .net** или создания пользовательских структур архива.

### Шаг 1: Инициализировать каталог документов

Установите переменную `dataDir` в путь к директории, которую нужно сжать.

```csharp
string dataDir = "Your Document Directory";
```

### Шаг 2: Создать выходные ZIP‑файлы

Откройте два объекта `FileStream` для выходных ZIP‑файлов. Это показывает, как можно генерировать более одного архива из одного источника — полезно для версионных резервных копий.

```csharp
using (FileStream zipFile = File.Open(dataDir + "CompressDirectory_out.zip", FileMode.Create))
{
    using (FileStream zipFile2 = File.Open(dataDir + "CompressDirectory2_out.zip", FileMode.Create))
    {
```

### Шаг 3: Сжать каталог

Используйте класс `Archive`, чтобы добавить каждую запись из целевой папки. В примере используется образцовая папка **CanterburyCorpus**, но вы можете указать любую директорию.

```csharp
        using (Archive archive = new Archive())
        {
            DirectoryInfo corpus = new DirectoryInfo(dataDir + "CanterburyCorpus");
            archive.CreateEntries(corpus);
            archive.Save(zipFile);
            archive.Save(zipFile2);
        }
    }
}
```

> **Совет профессионала:** Если необходимо **create zip archive .net** с определённым уровнем сжатия, задайте `archive.CompressionLevel` перед вызовом `Save`.

## Распространённые проблемы и решения

| Симптом | Вероятная причина | Исправление |
|---------|-------------------|-------------|
| Пустой ZIP‑файл | `dataDir` указывает на неверную папку или отсутствует завершающий слеш | Проверьте путь и убедитесь, что в папке есть файлы |
| `UnauthorizedAccessException` | Приложение не имеет прав доступа к файловой системе | Запустите Visual Studio от имени администратора или предоставьте права чтения/записи |
| Большой расход памяти для огромных каталогов | Все записи загружаются в память одновременно | Используйте `Archive.CreateEntryFromFile` в цикле, чтобы потоково обрабатывать файлы по отдельности |

## Часто задаваемые вопросы (дополнительно)

**В: Можно ли добавить пароль к ZIP‑архиву?**  
О: Да. Установите `archive.Password = "yourPassword";` перед вызовом `Save`.

**В: Как включить только определённые типы файлов?**  
О: Отфильтруйте коллекцию `DirectoryInfo` с помощью `GetFiles("*.txt")` или аналогичного метода перед вызовом `CreateEntries`.

**В: Есть ли способ обновить существующий ZIP без полного пересоздания?**  
О: Aspose.Zip поддерживает инкрементные обновления через `Archive.UpdateEntry`.

## FAQ

### В1: Можно ли использовать Aspose.Zip для .NET в коммерческих и личных проектах?

О1: Да, Aspose.Zip for .NET лицензируется как для коммерческого, так и для личного использования.

### В2: Доступна ли бесплатная пробная версия?

О2: Да, вы можете попробовать бесплатную версию [здесь](https://releases.aspose.com/zip/net).

### В3: Как получить поддержку по Aspose.Zip для .NET?

О3: Посетите [форум Aspose.Zip](https://forum.aspose.com/c/zip/37) для поддержки сообщества или рассмотрите покупку [временной лицензии](https://purchase.aspose.com/temporary-license/) для индивидуальной помощи.

### В4: Есть ли другие примеры и руководства?

О4: Да, в [документации](https://reference.aspose.com/zip/net/) содержатся обширные примеры и учебные материалы.

### В5: Можно ли купить Aspose.Zip для .NET?

О5: Конечно, оформить покупку можно [здесь](https://purchase.aspose.com/buy).

---

**Последнее обновление:** 2026-02-12  
**Тестировано с:** Aspose.Zip 24.11 for .NET  
**Автор:** Aspose  

---

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}

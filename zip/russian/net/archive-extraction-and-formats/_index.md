---
date: 2026-01-28
description: Узнайте, как извлекать архивы с паролем, сжимать файлы в TarBz2 и создавать
  архивы TarGz с помощью Aspose.Zip для .NET. Повышайте эффективность хранения и безопасность.
linktitle: Archive Extraction and Formats
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Извлечение архива с паролем и сжатие в TarBz2 (.NET)
url: /ru/net/archive-extraction-and-formats/
weight: 23
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Извлечение архива с паролем и сжатие в TarBz2 (.NET)

В этом руководстве вы узнаете **как извлечь архив с паролем** и также освоите **сжатие файлов в TarBz2** с помощью Aspose.Zip for .NET. Независимо от того, создаёте ли вы сервис резервного копирования, клиент облачного хранилища или конвейер обработки данных, эти техники позволяют уменьшить объём хранилища, ускорить передачу и защитить конфиденциальные данные.

## Быстрые ответы
- **What is TarBz2?** Сжатый архив, который объединяет упаковку TAR с компрессией BZIP2 для высокого коэффициента сжатия.  
- **Why choose Aspose.Zip for .NET?** Предоставляет единый, удобный API для множества форматов архивов без нативных зависимостей.  
- **Can I create a TarGz archive?** Да — Aspose.Zip поддерживает TarGz, TarLz, TarXz, TarZ и другие.  
- **How do I extract a password‑protected archive?** Установите свойство `Password` у каждого `ArchiveEntry` перед извлечением.  
- **Do I need a license for production use?** Для продакшн‑использования требуется коммерческая лицензия; доступна бесплатная пробная версия для оценки.

## Как извлечь архив с паролем с помощью Aspose.Zip for .NET
Извлечение архива, защищённого **паролем zip‑архива**, простое. Вы открываете архив, находите нужный элемент, задаёте его пароль и вызываете `Extract`. Такой подход работает для TarBz2, TarGz и других поддерживаемых форматов.

## Что на самом деле означает «сжатие файлов в TarBz2»?
Сжатие файлов в TarBz2 означает сначала объединить несколько файлов и каталогов в один контейнер **TAR**, а затем применить компрессию **BZIP2**. В результате получается файл `.tar.bz2`, который одновременно удобен для передачи и сильно сжат.

## Почему использовать Aspose.Zip for .NET для работы с этими форматами?
- **Unified API** — Одна библиотека, множество форматов (TarBz2, TarGz, TarLz, TarXz, TarZ).  
- **No native dependencies** — Работает на Windows, Linux и macOS сразу же.  
- **Password support** — Надёжно защищать и извлекать архивы с паролями для отдельных элементов.  
- **Performance‑focused** — Обработка на основе потоков минимизирует использование памяти.

## Предварительные требования
- .NET 6.0 или новее (или .NET Core 3.1+ / .NET Framework 4.5+).  
- Установленный NuGet‑пакет Aspose.Zip for .NET (`Install-Package Aspose.Zip`).  
- Базовые знания C# и работы с файлами.

## Пошаговое руководство

### Шаг 1: Выберите нужный формат архива
Определите, какой из форматов — **TarBz2**, **TarGz**, **TarLz**, **TarXz** или **TarZ** — лучше всего соответствует вашим требованиям к коэффициенту сжатия и совместимости.  
- **TarBz2** — Наилучшее сжатие, более медленная обработка.  
- **TarGz** — Хороший баланс скорости и размера (охватывает вторичное ключевое слово *compress files to targz*).  
- **TarZ** — Устаревший формат для старых Unix‑утилит.

### Шаг 2: Создайте новый экземпляр `Archive`
Создайте экземпляр класса `Archive` и укажите путь к выходному файлу. Этот объект будет управлять процессом упаковки и сжатия.

### Шаг 3: Добавьте файлы и папки
Используйте методы `AddAll` или `AddFile` для включения файлов, которые нужно сжать. Сохраните структуру каталогов, добавив базовую папку.

### Шаг 4: Установите желаемый тип сжатия
Укажите алгоритм сжатия (`CompressionType.BZip2`, `CompressionType.GZip` и т.д.) при сохранении архива. Здесь вы фактически **сжимаете файлы в tarbz2** или любой другой формат.

### Шаг 5: Сохраните архив
Вызовите `Save`, передав соответствующий enum формата (`ArchiveFormat.TarBz2`, `ArchiveFormat.TarGz` и т.д.). Библиотека записывает контейнер TAR и применяет выбранное сжатие за один проход.

### Шаг 6: Извлеките архивы с паролями
Если вам нужно **извлечь элементы архива с разными паролями** (вторичное ключевое слово *how to extract password protected archive*), откройте архив, найдите каждый элемент, задайте его пароль и затем извлеките.

### Шаг 7: Проверьте результат
После извлечения сравните размеры файлов и контрольные суммы, чтобы убедиться, что архив был создан и распакован корректно.

## Распространённые сценарии использования
- **Backup utilities** — Храните ежедневные резервные копии в виде `.tar.bz2`, чтобы минимизировать затраты на хранение.  
- **Cross‑platform data exchange** — Форматы на основе Tar универсально понимаются в Linux, macOS и Windows.  
- **Secure distribution** — Защищайте отдельные элементы паролями для сред, требующих соответствия.

## Устранение неполадок и советы
- **Large archives** — Используйте потоковые API (`Archive.CreateEntryFromFile`), чтобы избежать загрузки целых файлов в память.  
- **Password mismatches** — Убедитесь, что пароль, установленный у каждого `ArchiveEntry`, совпадает с тем, который используется при извлечении; иначе возникнет `InvalidPasswordException`.  
- **Unsupported compression level** — BZIP2 не поддерживает пользовательские уровни сжатия; если требуется более тонкая настройка, рассмотрите TarLz или TarXz.  
- **Performance tip** — При создании **create tarbz2 archive** включите буферизацию базового потока, чтобы повысить скорость записи.

## Часто задаваемые вопросы

**Q: Как создать архив TarGz?**  
A: Установите тип сжатия `CompressionType.GZip` и формат `ArchiveFormat.TarGz` при вызове `Save`.

**Q: Можно ли извлечь архив, защищённый паролем, не зная пароль?**  
A: Нет. Каждый элемент должен быть снабжён правильным паролем; иначе извлечение завершится неудачей.

**Q: Поддерживает ли Aspose.Zip извлечение архивов с разными паролями для каждого элемента?**  
A: Да. Вы можете назначить пароль каждому `ArchiveEntry` отдельно перед извлечением.

**Q: Какой формат обеспечивает лучшее сжатие?**  
A: Обычно TarBz2 даёт наивысший коэффициент сжатия, затем TarLz и TarXz. TarGz обеспечивает хороший баланс скорости и размера.

**Q: Есть ли ограничение на количество файлов, которые можно добавить в TAR‑архив?**  
A: Практически нет, но очень большие архивы могут выиграть от разбивки на несколько частей для облегчения обработки.

## Руководства по извлечению архивов и форматам
### [Сжатие файлов в TarBz2 с Aspose.Zip for .NET](./compress-to-tar-bz2/)
### [Сжатие в TarGz с Aspose.Zip for .NET](./compress-to-tar-gz/)
### [Сжатие в TarLz с Aspose.Zip for .NET](./compress-to-tar-lz/)
### [Сжатие в TarXz с Aspose.Zip for .NET](./compress-to-tar-xz/)
### [Сжатие в TarZ с Aspose.Zip for .NET](./compress-to-tar-z/)
### [Извлечение элементов архива с разными паролями в Aspose.Zip for .NET](./extract-archive-different-passwords/)

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}

---

**Последнее обновление:** 2026-01-28  
**Тестировано с:** Aspose.Zip for .NET 24.11  
**Автор:** Aspose
---
date: 2025-12-01
description: Узнайте, как извлекать ZIP‑архивы с паролем с помощью Aspose.Zip для
  .NET, эффективно обрабатывая несколько защищённых паролем записей.
language: ru
linktitle: Extracting Archive Entries with Different Passwords
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Как извлечь ZIP‑архив с паролем с помощью Aspise.Zip для .NET
url: /net/archive-extraction-and-formats/extract-archive-different-passwords/
weight: 10
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Как извлечь ZIP‑архив с паролем, используя Aspose.Zip для .NET

В современных .NET‑приложениях защита конфиденциальных данных внутри ZIP‑архивов является распространённой задачей. Этот учебник показывает **как извлечь zip с паролем**, когда у каждой записи свой пароль, предоставляя тонкую настройку безопасности при простом процессе извлечения.

## Быстрые ответы
- **Какую библиотеку использовать?** Aspose.Zip для .NET.  
- **Можно ли извлекать записи с разными паролями?** Да — каждая запись может открываться своим паролем.  
- **Нужна ли лицензия для продакшна?** Требуется коммерческая лицензия; доступна бесплатная пробная версия.  
- **Поддерживаемые платформы?** .NET Framework, .NET Core, .NET 5/6+.  
- **Типичное время реализации?** Около 10 минут для базового сценария.

## Предварительные требования

Прежде чем приступить, убедитесь, что у вас есть:

- **Aspose.Zip для .NET**, установленный в проекте. Официальную документацию можно найти [здесь](https://reference.aspose.com/zip/net/).  
- Среда разработки .NET (Visual Studio, Rider или VS Code) с целевой платформой .NET 5 или новее.  
- ZIP‑файл, содержащий записи, зашифрованные **разными паролями** (в примере используется `different_password.zip`).

## Импорт пространств имён

Сначала импортируйте необходимые пространства имён для работы с архивами:

```csharp
using Aspose.Zip;
using System.IO;
```

Эти два оператора `using` дают доступ к классу `Archive` и стандартным утилитам ввода‑вывода.

## Шаг 1: Определите рабочий каталог

Укажите папку, где находится ZIP‑файл, и куда будут записаны извлечённые файлы:

```csharp
string dataDir = "Your Document Directory";
```

> **Совет:** Используйте `Path.Combine` для построения путей кроссплатформенно, если необходимо поддерживать Linux/macOS.

## Шаг 2: Извлечение записей архива с разными паролями

Ниже пошагово показано, как открыть архив и извлечь каждую запись, используя её собственный пароль.

### Шаг 2.1: Откройте ZIP‑файл

```csharp
using (FileStream zipFile = File.Open(dataDir + "\\different_password.zip", FileMode.Open))
{
    using (Archive archive = new Archive(zipFile))
    {
        // Continue to the next steps...
    }
}
```

Объект `Archive` представляет контейнер ZIP. Размещение `FileStream` и `Archive` внутри блоков `using` гарантирует своевременное освобождение ресурсов.

### Шаг 2.2: Извлеките первую запись (пароль = “first_pass”)

```csharp
archive.Entries[0].Extract(dataDir + "alice29_extracted_pass_out.txt", "first_pass");
```

Здесь мы **извлекаем несколько записей zip**, обращаясь к ним через коллекцию `Entries`. Первая запись расшифровывается паролем `"first_pass"`.

### Шаг 2.3: Извлеките вторую запись (пароль = “second_pass”)

```csharp
archive.Entries[1].Extract(dataDir + "asyoulik_extracted_pass_out.txt", "second_pass");
```

Вторая запись использует другой пароль, демонстрируя **извлечение zip‑архивов, защищённых паролем**, для каждого отдельного файла.

## Почему этот подход важен

- **Тонкая безопасность:** Каждый файл может иметь собственный пароль, снижая риск при компрометации одного пароля.  
- **Гибкость:** Вы можете программно выбирать пароль в зависимости от бизнес‑логики (например, ролей пользователей).  
- **Производительность:** Aspose.Zip обрабатывает записи в памяти, избегая необходимости распаковывать весь архив целиком.

## Распространённые проблемы и решения

| Проблема | Причина | Решение |
|----------|---------|---------|
| *“Invalid password” exception* | Неправильный пароль или запись не зашифрована. | Проверьте строку пароля и убедитесь, что запись действительно защищена паролем. |
| *File not found* | Неправильный путь `dataDir`. | Используйте `Path.Combine(dataDir, "different_password.zip")` и проверьте правильность папки. |
| *Large archives cause high memory usage* | По умолчанию все записи загружаются в память. | Обрабатывайте каждую запись по отдельному потоку или используйте `Archive.ExtractToDirectory` с обратным вызовом пароля (если поддерживается). |

## Часто задаваемые вопросы

**В1: Можно ли использовать Aspose.Zip как в проектах .NET Core, так и в .NET Framework?**  
О1: Да, Aspose.Zip поддерживает .NET Framework, .NET Core и .NET 5/6+, что даёт гибкость на разных платформах.

**В2: Где можно найти дополнительную поддержку или обсуждения сообщества по Aspose.Zip?**  
О2: Посетите [форум Aspose.Zip](https://forum.aspose.com/c/zip/37), где можно задать вопросы и поделиться опытом.

**В3: Есть ли бесплатная пробная версия Aspose.Zip?**  
О3: Да, бесплатную пробную версию Aspose.Zip можно получить [здесь](https://releases.aspose.com/).

**В4: Как получить временную лицензию для Aspose.Zip?**  
О4: Для временной лицензии перейдите по [этой ссылке](https://purchase.aspose.com/temporary-license/).

**В5: Где можно приобрести Aspose.Zip?**  
О5: Для покупки Aspose.Zip посетите [страницу покупки](https://purchase.aspose.com/buy).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}

---

**Последнее обновление:** 2025-12-01  
**Тестировано с:** Aspose.Zip для .NET 24.11 (на момент написания)  
**Автор:** Aspose  

---
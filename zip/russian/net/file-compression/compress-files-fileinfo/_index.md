---
date: 2026-02-05
description: Узнайте, как упаковать несколько файлов в C# и создать zip‑архив в .NET
  с помощью Aspose.Zip. Это пошаговое руководство показывает сжатие файлов с использованием
  FileInfo в проектах ASP.NET.
linktitle: Compress Files using FileInfo
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Как заархивировать несколько файлов в C# с помощью Aspose.Zip для .NET
url: /ru/net/file-compression/compress-files-fileinfo/
weight: 11
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Как архивировать несколько файлов c# с помощью Aspose.Zip для .NET

## Введение

Если вам нужно **zip multiple files c#** программно, Aspose.Zip для .NET предоставляет чистый, высокопроизводительный API, который работает в любом .NET (включая ASP.NET) приложении. В этом руководстве мы пройдем процесс сжатия файлов с помощью класса `FileInfo`, покажем, как **add files to zip**, и объясним, почему этот подход идеален для современных .NET проектов. Давайте начнём!

## Быстрые ответы
- **Какой самый простой способ создать zip‑архив?** Используйте класс `Archive` из Aspose.Zip вместе с объектами `FileInfo`.  
- **Можно ли добавить несколько файлов сразу?** Да — просто создайте `FileInfo` для каждого файла и вызовите `CreateEntry`.  
- **Нужна ли специальная лицензия для ASP.NET?** Для продакшн‑использования требуется коммерческая лицензия Aspose.Zip; бесплатная пробная версия подходит для оценки.  
- **Какие версии .NET поддерживаются?** .NET Framework 4.5+, .NET Core 3.1+, .NET 5/6/7.  
- **API потокобезопасен?** Да, при условии, что каждый поток работает со своим экземпляром `Archive`.  
- **Как архивировать файлы c# без загрузки их в память?** Используйте объекты `FileInfo` — они передают данные напрямую.  

## Как архивировать несколько файлов c#

Zip‑архив объединяет один или несколько файлов в один сжатый контейнер. Это экономит место на диске, ускоряет передачу по сети и упрощает распространение. Независимо от того, отправляете ли вы журналы, экспортируете отчёты или упаковываете ресурсы для клиента, знание **how to zip files c#** программно является ценным навыком для любого .NET‑разработчика.

## Почему стоит использовать Aspose.Zip для добавления файлов в zip?

- **Отсутствие внешних зависимостей** — чистая реализация на .NET.  
- **Полный контроль над уровнем сжатия и кодировкой** (ASCII, UTF‑8 и т.д.).  
- **Поддерживает большие файлы** (> 4 GB) и защиту паролем.  
- **Последовательный API для .NET Framework, .NET Core и .NET 5+**.  

## Предварительные требования

Перед тем как перейти к коду, убедитесь, что у вас есть:

1. **Aspose.Zip for .NET** установлен. Скачайте последнюю версию с [страницы загрузки Aspose.Zip](https://releases.aspose.com/zip/net/).  
2. Папка на вашем компьютере, содержащая файлы, которые нужно сжать (например, `alice29.txt` и `fields.c`).  

## Импорт пространств имён

В любом C#‑файле, где вы будете работать с zip‑архивами, добавьте следующие `using`‑операторы:

```csharp
using Aspose.Zip;
using Aspose.Zip.Saving;
using Aspose.ZIP;
using System.IO;
using System.Text;
```

Эти пространства имён дают доступ к классу `Archive`, параметрам сохранения и стандартным утилитам ввода‑вывода.

## Пошаговое руководство

### Шаг 1: Настройте каталог документов

Сначала определите папку, в которой находятся исходные файлы. Замените заполнитель на абсолютный или относительный путь в вашей системе:

```csharp
string dataDir = "Your Document Directory";
```

> **Совет:** Используйте `Path.Combine` для построения путей кроссплатформенно.

### Шаг 2: Откройте zip‑файл для записи

Создайте `FileStream`, указывающий на выходной zip‑файл. Поток открывается в режиме **Create**, который перезаписывает любой существующий файл с тем же именем:

```csharp
using (FileStream zipFile = File.Open(dataDir + "CompressFilesByFileInfo_out.zip", FileMode.Create))
{
```

### Шаг 3: Подготовьте объекты `FileInfo` для каждого исходного файла

`FileInfo` дает Aspose.Zip прямой доступ к физическим файлам на диске. Создайте один экземпляр для каждого файла, который хотите сжать:

```csharp
FileInfo fi1 = new FileInfo(dataDir + "alice29.txt");
FileInfo fi2 = new FileInfo(dataDir + "fields.c");
```

> **Почему использовать `FileInfo`?** Он избегает загрузки всего файла в память, что особенно полезно для больших файлов.

### Шаг 4: Создайте архив и добавьте записи

Создайте объект `Archive`, затем вызовите `CreateEntry` для каждого `FileInfo`. Первый аргумент — имя файла внутри zip, второй аргумент — исходный `FileInfo`:

```csharp
using (var archive = new Archive())
{
    archive.CreateEntry("alice29.txt", fi1);
    archive.CreateEntry("fields.c", fi2);
```

### Шаг 5: Сохраните zip‑архив с нужной кодировкой

Наконец, сохраните архив в `FileStream`, который вы открыли ранее. Здесь мы используем ASCII‑кодировку для имён записей, но при необходимости можете переключиться на UTF‑8, если имена файлов содержат не‑ASCII символы:

```csharp
    archive.Save(zipFile, new ArchiveSaveOptions() { Encoding = Encoding.ASCII });
}
```

Когда блоки `using` завершаются, потоки автоматически закрываются, и zip‑файл готов к использованию.

## Распространённые проблемы и решения

| Проблема | Причина | Решение |
|----------|----------|----------|
| **Пустой zip‑файл** | `FileInfo` указывает на несуществующий путь | Проверьте `dataDir` и имена файлов; используйте `File.Exists` для проверки перед созданием записей. |
| **Неправильная кодировка имени файла** | Использование кодировки по умолчанию с не‑ASCII именами | Установите `Encoding = Encoding.UTF8` в `ArchiveSaveOptions`. |
| **OutOfMemoryException при больших файлах** | Загрузка всего файла в память | `FileInfo` передаёт файл потоково; убедитесь, что вы не читаете файл в массив байтов в другом месте. |
| **Отказ в доступе** | Приложению не хватает прав записи в целевую папку | Запустите приложение с нужными правами или выберите папку с правом записи. |

## Часто задаваемые вопросы

**В: Можно ли добавить защиту паролем к zip‑архиву?**  
**О:** Да. После создания `Archive` установите `archive.Password = "yourPassword"` перед вызовом `Save`.

**В: Можно ли обновить существующий zip‑файл?**  
**О:** Aspose.Zip поддерживает открытие существующего архива с помощью `Archive.Open` и последующее добавление новых записей.

**В: Как сжать файлы в контроллере ASP.NET MVC?**  
**О:** Тот же код работает; просто убедитесь, что поток вывода возвращается клиенту как `FileResult`.

**В: Поддерживает ли Aspose.Zip алгоритмы шифрования?**  
**О:** Поддерживает стандартный ZipCrypto и шифрование AES‑256.

**В: Что делать, если нужно рекурсивно сжать папку?**  
**О:** Пройдитесь по `Directory.GetFiles` (и подпапкам), создайте `FileInfo` для каждого файла и добавьте их в архив.

## Существующий раздел FAQ (оставлен без изменений)

### FAQ

#### Q1: Совместим ли Aspose.Zip со всеми типами файлов?

A1: Aspose.Zip поддерживает широкий спектр типов файлов, обеспечивая универсальность при сжатии.

#### Q2: Можно ли использовать Aspose.Zip в коммерческих проектах?

A2: Абсолютно! Посетите нашу [страницу покупки](https://purchase.aspose.com/buy), чтобы ознакомиться с вариантами лицензирования.

#### Q3: Как получить поддержку по Aspose.Zip?

A3: Присоединяйтесь к нашему сообществу на [форуме Aspose.Zip](https://forum.aspose.com/c/zip/37) для получения помощи и обсуждений.

#### Q4: Доступна ли бесплатная пробная версия?

A4: Да, вы можете получить [бесплатную пробную версию здесь](https://releases.aspose.com/).

#### Q5: Как получить временную лицензию для Aspose.Zip?

A5: Перейдите по [этой ссылке](https://purchase.aspose.com/temporary-license/), чтобы узнать, как оформить временную лицензию.

## Заключение

Теперь вы знаете **how to zip files c#** с помощью Aspose.Zip для .NET, как **add files to zip**, и почему этот метод идеален для ASP.NET и других .NET приложений. Экспериментируйте с различными уровнями сжатия, кодировками и параметрами шифрования, чтобы адаптировать архив под свои точные требования. Приятного сжатия!

**Last Updated:** 2026-02-05  
**Tested With:** Aspose.Zip for .NET 24.12 (latest)  
**Author:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
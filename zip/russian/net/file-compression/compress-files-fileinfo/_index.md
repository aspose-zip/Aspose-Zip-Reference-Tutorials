---
date: 2026-02-28
description: Узнайте, как добавить папку в zip и добавить файлы в zip с помощью Aspose.Zip
  для .NET. Это пошаговое руководство показывает, как сжимать файлы с использованием
  FileInfo в проектах ASP.NET.
linktitle: Compress Files using FileInfo
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Как добавить папку в ZIP с помощью Aspose.Zip для .NET – Сжатие файлов с использованием
  FileInfo
url: /ru/net/file-compression/compress-files-fileinfo/
weight: 11
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Как добавить папку в ZIP с помощью Aspose.Zip для .NET

## Введение

Если вам нужно **программно создать ZIP‑архив**, Aspose.Zip для .NET предоставляет чистый, высокопроизводительный API, который работает в любом приложении .NET (включая ASP.NET). В этом руководстве мы пройдем процесс сжатия файлов с помощью класса `FileInfo`, покажем, как **добавлять файлы в ZIP**, и объясним, почему такой подход идеален для современных проектов .NET. Мы также расскажем, как **добавить папку в ZIP**, чтобы упаковать целые каталоги за один шаг. Поехали!

## Быстрые ответы
- **Какой самый простой способ создать ZIP‑архив?** Использовать класс `Archive` из Aspose.Zip вместе с объектами `FileInfo`.  
- **Можно ли добавить несколько файлов сразу?** Да — просто создайте `FileInfo` для каждого файла и вызовите `CreateEntry`.  
- **Нужна ли специальная лицензия для ASP.NET?** Для продакшн‑использования требуется коммерческая лицензия Aspose.Zip; бесплатная trial‑версия подходит для оценки.  
- **Какие версии .NET поддерживаются?** .NET Framework 4.5+, .NET Core 3.1+, .NET 5/6/7.  
- **Является ли API потокобезопасным?** Да, при условии, что каждый поток работает со своим экземпляром `Archive`.

## Что такое ZIP‑архив и зачем его создавать?
ZIP‑архив объединяет один или несколько файлов в единый сжатый контейнер. Это экономит место на диске, ускоряет передачу по сети и упрощает распространение. Будь то логи, отчёты или набор ресурсов для клиента, умение **создавать ZIP‑архивы** программно — ценное навыковое преимущество для любого разработчика .NET.

## Почему стоит использовать Aspose.Zip для добавления файлов в ZIP?
- **Никаких внешних зависимостей** — чистая реализация на .NET.  
- **Полный контроль над уровнем сжатия и кодировкой** (ASCII, UTF‑8 и др.).  
- **Поддержка больших файлов** (> 4 GB) и защиты паролем.  
- **Единый API для .NET Framework, .NET Core и .NET 5+**.

## Предварительные требования

Прежде чем перейти к коду, убедитесь, что у вас есть:

1. **Aspose.Zip для .NET** установлен. Скачайте последнюю версию с [страницы загрузки Aspose.Zip](https://releases.aspose.com/zip/net/).  
2. Папка на вашем компьютере, содержащая файлы, которые нужно сжать (например, `alice29.txt` и `fields.c`).  

## Подключение пространств имён

В любом C#‑файле, где вы будете работать с ZIP‑архивами, добавьте следующие `using`‑директивы:

```csharp
using Aspose.Zip;
using Aspose.Zip.Saving;
using Aspose.ZIP;
using System.IO;
using System.Text;
```

Эти пространства имён дают доступ к классу `Archive`, параметрам сохранения и стандартным утилитам ввода‑вывода.

## Пошаговое руководство

### Шаг 1: Укажите каталог с исходными файлами

Сначала задайте папку, в которой находятся исходные файлы. Замените заполнители на абсолютный или относительный путь в вашей системе:

```csharp
string dataDir = "Your Document Directory";
```

> **Совет:** Используйте `Path.Combine` для построения путей кроссплатформенно.

### Шаг 2: Откройте ZIP‑файл для записи

Создайте `FileStream`, указывающий на результирующий ZIP‑файл. Поток открывается в режиме **Create**, который перезаписывает любой существующий файл с тем же именем:

```csharp
using (FileStream zipFile = File.Open(dataDir + "CompressFilesByFileInfo_out.zip", FileMode.Create))
{
```

### Шаг 3: Подготовьте объекты `FileInfo` для каждого исходного файла

`FileInfo` даёт Aspose.Zip прямой доступ к физическим файлам на диске. Создайте один экземпляр для каждого файла, который хотите сжать:

```csharp
FileInfo fi1 = new FileInfo(dataDir + "alice29.txt");
FileInfo fi2 = new FileInfo(dataDir + "fields.c");
```

> **Зачем использовать `FileInfo`?** Он избегает загрузки полного содержимого файла в память, что особенно важно для больших файлов.

### Шаг 4: Создайте архив и добавьте записи

Создайте объект `Archive`, затем вызовите `CreateEntry` для каждого `FileInfo`. Первый аргумент — имя файла внутри ZIP, второй аргумент — исходный `FileInfo`:

```csharp
using (var archive = new Archive())
{
    archive.CreateEntry("alice29.txt", fi1);
    archive.CreateEntry("fields.c", fi2);
```

### Шаг 5: Сохраните ZIP‑архив с нужной кодировкой

Наконец, запишите архив в ранее открытый `FileStream`. Здесь мы используем ASCII‑кодировку для имён записей, но при необходимости можете переключиться на UTF‑8, если ваши имена содержат не‑ASCII символы:

```csharp
    archive.Save(zipFile, new ArchiveSaveOptions() { Encoding = Encoding.ASCII });
}
```

Когда блоки `using` завершаются, потоки автоматически закрываются, и ZIP‑файл готов к использованию.

## Как добавить папку в ZIP с помощью Aspose.Zip

Если нужно **добавить папку в ZIP**, а не отдельные файлы, процесс прост:

1. **Переберите содержимое папки** с помощью `DirectoryInfo.GetFiles` (и при необходимости `GetDirectories` для рекурсии).  
2. **Создайте `FileInfo`** для каждого найденного файла.  
3. **Вызовите `CreateEntry`** с относительным путём, включающим имя папки, например `"MyFolder/Report.pdf"`.  

Поскольку API работает с `FileInfo`, вам никогда не придётся загружать целые файлы в память, что делает процесс безопасным даже для больших каталогов. Этот приём также подходит для сценариев **zip multiple files asp.net**, когда вы формируете набор отчётов «на лету» и хотите отдать их в виде единого архива.

## Распространённые проблемы и решения

| Проблема | Причина | Решение |
|----------|---------|----------|
| **Пустой ZIP‑файл** | `FileInfo` указывает на несуществующий путь | Проверьте `dataDir` и имена файлов; используйте `File.Exists` перед созданием записей. |
| **Неправильная кодировка имён файлов** | По умолчанию используется кодировка, не поддерживающая не‑ASCII символы | Установите `Encoding = Encoding.UTF8` в `ArchiveSaveOptions`. |
| **OutOfMemoryException при работе с большими файлами** | Загрузка полного файла в память | `FileInfo` потоковый; убедитесь, что вы не читаете файл в массив байтов где‑то ещё. |
| **Отказ в доступе** | Приложение не имеет прав записи в целевую папку | Запустите приложение с нужными правами или выберите каталог с правом записи. |

## Часто задаваемые вопросы

**В: Можно ли добавить защиту паролем к ZIP‑архиву?**  
О: Да. После создания `Archive` задайте `archive.Password = "yourPassword"` перед вызовом `Save`.

**В: Можно ли обновлять уже существующий ZIP‑файл?**  
О: Aspose.Zip поддерживает открытие существующего архива через `Archive.Open` и последующее добавление новых записей.

**В: Как сжать файлы в контроллере ASP.NET MVC?**  
О: Тот же код работает; просто убедитесь, что выходной поток возвращается как `FileResult` клиенту.

**В: Поддерживает ли Aspose.Zip алгоритмы шифрования?**  
О: Да, поддерживаются стандартные ZipCrypto и AES‑256.

**В: Как рекурсивно сжать папку?**  
О: Пройдите `Directory.GetFiles` (и подпапки) и создайте `FileInfo` для каждого файла, затем добавьте их в архив.

## Дополнительные FAQ

**В: Как создавать ZIP‑архивы в .NET для больших наборов данных?**  
О: Используйте `FileInfo` для потоковой передачи и задавайте `CompressionLevel` в `ArchiveSaveOptions` для оптимальной производительности.

**В: Можно ли использовать Aspose.Zip в .NET Core Web API (zip files asp.net core)?**  
О: Абсолютно — библиотека полностью совместима с .NET Core 3.1 и более новыми версиями.

**В: Есть ли способ добавить папку в ZIP без собственного цикла?**  
О: В Aspose.Zip нет единого метода «add folder», но перебор через `DirectoryInfo` лёгок и даёт полный контроль над именами записей.

**В: Влияет ли защита паролем на скорость сжатия?**  
О: Шифрование добавляет небольшие накладные расходы, но влияние минимально для большинства сценариев.

**В: Какая лицензия требуется для коммерческого развертывания?**  
О: Для продакшн‑использования нужна платная лицензия Aspose.Zip; бесплатная trial‑версия подходит для разработки и тестирования.

## Существующий раздел FAQ (оставлен без изменений)

### FAQ's

#### Q1: Совместим ли Aspose.Zip со всеми типами файлов?

A1: Aspose.Zip поддерживает широкий спектр типов файлов, обеспечивая универсальность при сжатии.

#### Q2: Можно ли использовать Aspose.Zip в коммерческих проектах?

A2: Абсолютно! Посетите нашу [страницу покупки](https://purchase.aspose.com/buy) для ознакомления с вариантами лицензирования.

#### Q3: Как получить поддержку по Aspose.Zip?

A3: Присоединяйтесь к нашему сообществу на [форуме Aspose.Zip](https://forum.aspose.com/c/zip/37) для получения помощи и обсуждений.

#### Q4: Доступна ли бесплатная пробная версия?

A4: Да, вы можете получить [бесплатную trial‑версию здесь](https://releases.aspose.com/).

#### Q5: Как получить временную лицензию для Aspose.Zip?

A5: Перейдите по [этой ссылке](https://purchase.aspose.com/temporary-license/) для получения информации о временной лицензии.

## Заключение

Теперь вы знаете, **как добавить папку в ZIP** и **как создавать ZIP‑архивы** с помощью Aspose.Zip для .NET, как **добавлять файлы в ZIP**, и почему этот метод идеален для ASP.NET и других .NET‑приложений. Экспериментируйте с различными уровнями сжатия, кодировками и параметрами шифрования, чтобы настроить архив под свои точные требования. Приятного сжатия!

---

**Последнее обновление:** 2026-02-28  
**Тестировано с:** Aspose.Zip для .NET 24.12 (latest)  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
---
date: 2026-02-15
description: Узнайте, как сжимать файлы в C# с помощью Aspose.Zip для .NET, модифицировать
  zip‑файлы в C#, извлекать вложенные zip‑записи и создавать плоские архивы в пошаговом
  руководстве.
linktitle: Modifying Zip Files
second_title: Aspose.Zip .NET API for Files Compression & Archiving
title: Сжатие файлов C# с использованием Aspose.Zip — создание и изменение ZIP
url: /ru/net/file-compression/modifying-zip-files/
weight: 15
---

 shortcodes unchanged.

Now produce final content.{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Создание zip‑архива C# с использованием Aspose.Zip для .NET

## Введение

Сжатие файлов C# — распространённая задача, когда нужно передать данные, создать резервные копии или сократить затраты на хранение. Aspose.Zip для .NET устраняет низкоуровневую работу и позволяет сосредоточиться на **том**, чего вы хотите достичь — будь то создание совершенно нового архива, уплощение вложенных zip‑файлов или обновление существующего пакета.  

В этом руководстве вы узнаете, как **модифицировать zip‑файл C#**, извлекать вложенные zip‑записи, удалять ненужные элементы и, наконец, **сжимать файлы C#** в чистый, плоский архив. Такой подход отлично подходит для сервисов обработки файлов, автоматизированных конвейеров развертывания или любой ситуации, где необходимо программно работать с zip‑архивами.

## Быстрые ответы
- **Может ли Aspose.Zip создавать zip‑архив C#?** Да — класс `Archive` позволяет создавать и редактировать zip‑файлы непосредственно в C#.
- **Как извлечь вложенные zip‑файлы?** Откройте внешнюю запись как поток, создайте второй `Archive` из этого потока, затем перечислите его записи.
- **Нужна ли лицензия для разработки?** Бесплатная пробная версия подходит для оценки; для продакшна требуется коммерческая лицензия.
- **Поддерживаемые версии .NET?** .NET Framework 4.6+, .NET Core 3.1+, .NET 5/6/7.
- **Типичное время выполнения примера?** Менее секунды для нескольких мегабайт данных.

## Как сжимать файлы C# с помощью Aspose.Zip

Прежде чем переходить к коду, разберём, почему стоит выбрать Aspose.Zip вместо других библиотек:

- **Чистая реализация на .NET** — без нативных DLL, что упрощает развертывание в облачных сервисах.  
- **Полный контроль над записями** — вы можете добавлять, удалять, переименовывать или заменять файлы «на лету», что необходимо, когда нужно **модифицировать zip‑файл C#** программно.  
- **API, ориентированное на потоки** — работа напрямую с объектами `MemoryStream`, идеально подходит для обработки в памяти или безсерверных функций.  
- **Поддержка вложенных архивов** — извлечение вложенных zip‑файлов без записи временных файлов на диск.

## Что такое «создание zip‑архива C#»?

Создание zip‑архива в C# означает программную генерацию файла `.zip`, который может содержать произвольное количество файлов или папок, при необходимости применяя уровни сжатия, шифрование или пользовательские метаданные. Aspose.Zip абстрагирует сложность, позволяя сосредоточиться на бизнес‑логике, а не на самом формате zip‑файла.

## Почему использовать Aspose.Zip для .NET?

- **Нет внешних зависимостей** — чистая .NET‑библиотека, без нативных DLL.  
- **Полный контроль над записями** — добавление, удаление, переименование или замена файлов «на лету».  
- **API, ориентированное на потоки** — работа с объектами `MemoryStream`, идеально подходит для облачных или in‑memory сценариев.  
- **Надёжная работа с вложенными архивами** — легко **извлекать вложенные zip‑файлы** без временных файлов на диске.

## Предварительные требования

Прежде чем начать, убедитесь, что у вас есть:

1. **Aspose.Zip для .NET**, установленный в вашем проекте. Вы можете скачать его **[здесь](https://releases.aspose.com/zip/net/)**.  
2. Папка, содержащая исходные zip‑файлы, с которыми вы будете работать. Замените `"Your Document Directory"` в фрагментах кода на реальный путь на вашем компьютере.  
3. Среда разработки .NET (Visual Studio, VS Code или Rider), нацеленная на .NET Framework 4.6+ или .NET Core 3.1+.

## Импорт пространств имён

Сначала импортируйте необходимые пространства имён:

```csharp
using Aspose.Zip;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
```

## Как модифицировать zip‑файл C# с помощью Aspose.Zip

Ниже представлено пошаговое руководство, которое покажет, как открыть существующий архив, извлечь вложенные zip‑записи, уплощить структуру и, наконец, сохранить новый архив.

### Шаг 1: Открытие внешнего zip‑файла  

Мы начинаем с открытия существующего архива (`outer.zip`). Оператор `using` гарантирует автоматическое закрытие файла.

```csharp
using (Archive outer = new Archive(dataDir + "outer.zip"))
{
    // Code for Step 1
}
```

### Шаг 2: Определение вложенных zip‑записей  

Далее мы сканируем внешний архив в поиске записей, заканчивающихся на `.zip`. Это **внутренние zip‑файлы**, которые мы хотим извлечь.

```csharp
List<ArchiveEntry> entriesToDelete = new List<ArchiveEntry>();
List<string> namesToInsert = new List<string>();
List<MemoryStream> contentToInsert = new List<MemoryStream>();

foreach (ArchiveEntry entry in outer.Entries)
{
    if (entry.Name.EndsWith(".zip", StringComparison.InvariantCultureIgnoreCase))
    {
        entriesToDelete.Add(entry);
        MemoryStream innerCompressed = new MemoryStream();
        entry.Open().CopyTo(innerCompressed);
        
        // Code for extracting inner entries
    }
}
```

### Шаг 3: Извлечение вложенных записей  

Теперь мы рассматриваем каждый внутренний zip как отдельный `Archive`. Здесь мы **извлекаем вложенные zip‑файлы** и собираем их содержимое в памяти.

```csharp
using (Archive inner = new Archive(innerCompressed))
{
    foreach (ArchiveEntry ie in inner.Entries)
    {
        namesToInsert.Add(ie.Name);
        MemoryStream content = new MemoryStream();
        ie.Open().CopyTo(content);
        
        // Code for extracting content of inner entries
    }
}
```

### Шаг 4: Удаление записей вложенного архива  

Получив необходимые данные, мы удаляем оригинальные записи вложенных zip‑файлов из внешнего архива. Этот шаг по сути реализует логику **удаления zip‑записи C#**.

```csharp
foreach (ArchiveEntry e in entriesToDelete)
{
    outer.DeleteEntry(e);
}
```

### Шаг 5: Добавление изменённых записей во внешний zip  

Наконец, мы вновь вставляем извлечённые файлы во внешний архив, эффективно уплощая структуру, и сохраняем результат как `flatten.zip`.

```csharp
for (int i = 0; i < namesToInsert.Count; i++)
{
    outer.CreateEntry(namesToInsert[i], contentToInsert[i]);
}

outer.Save(dataDir + "flatten.zip");
```

Следуя этим пяти шагам, вы **создали zip‑архив C#**, содержащий те же файлы, что и оригинал, но без вложенных zip‑слоёв.

## Распространённые проблемы и решения

| Проблема | Почему происходит | Исправление |
|----------|-------------------|-------------|
| `ArgumentNullException` при открытии вложенного архива | Позиция потока `innerCompressed` находится в конце | Вызовите `innerCompressed.Position = 0;` перед созданием `Archive` |
| Большие файлы вызывают высокое использование памяти | Все вложенные записи хранятся в объектах `MemoryStream` | Используйте временные файлы на диске (`Path.GetTempFileName()`) для очень больших архивов |
| Отсутствие записей после уплощения | Забыл добавить извлечённый контент в список `contentToInsert` | Убедитесь, что `contentToInsert.Add(content);` вызывается внутри внутреннего цикла |

## Часто задаваемые вопросы

### Вопрос 1: Могу ли я использовать Aspose.Zip для .NET с другими языками программирования?

ОТВ: Aspose.Zip в первую очередь предназначен для приложений .NET. Тем не менее, Aspose предоставляет библиотеки для различных языков программирования, каждая из которых адаптирована к своей среде.

### Вопрос 2: Доступна ли бесплатная пробная версия Aspose.Zip для .NET?

ОТВ: Да, бесплатную пробную версию можно получить **[здесь](https://releases.aspose.com/)**.

### Вопрос 3: Как получить поддержку Aspose.Zip для .NET?

ОТВ: Для поддержки и обсуждений посетите **[форум Aspose.Zip](https://forum.aspose.com/c/zip/37)**.

### Вопрос 4: Можно ли приобрести временную лицензию для Aspose.Zip для .NET?

ОТВ: Да, временную лицензию можно получить **[здесь](https://purchase.aspose.com/temporary-license/)**.

### Вопрос 5: Где найти документацию по Aspose.Zip для .NET?

ОТВ: Документация доступна **[здесь](https://reference.aspose.com/zip/net/)**.

---

**Последнее обновление:** 2026-02-15  
**Тестировано с:** Aspose.Zip 24.12 for .NET  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}